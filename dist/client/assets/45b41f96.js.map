{"version":3,"file":"45b41f96.js","sources":["../../../src/components/account/AccountLoginForm.client.jsx"],"sourcesContent":["import {useState} from 'react';\nimport {useNavigate, Link} from '@shopify/hydrogen/client';\n\nexport function AccountLoginForm({shopName}) {\n  const navigate = useNavigate();\n\n  const [hasSubmitError, setHasSubmitError] = useState(false);\n  const [showEmailField, setShowEmailField] = useState(true);\n  const [email, setEmail] = useState('');\n  const [emailError, setEmailError] = useState(null);\n  const [password, setPassword] = useState('');\n  const [passwordError, setPasswordError] = useState(null);\n\n  function onSubmit(event) {\n    event.preventDefault();\n\n    setEmailError(null);\n    setHasSubmitError(false);\n    setPasswordError(null);\n\n    if (showEmailField) {\n      checkEmail(event);\n    } else {\n      checkPassword(event);\n    }\n  }\n\n  function checkEmail(event) {\n    if (event.currentTarget.email.validity.valid) {\n      setShowEmailField(false);\n    } else {\n      setEmailError('Please enter a valid email');\n    }\n  }\n\n  async function checkPassword(event) {\n    const validity = event.currentTarget.password.validity;\n    if (validity.valid) {\n      const response = await callLoginApi({\n        email,\n        password,\n      });\n\n      if (response.error) {\n        setHasSubmitError(true);\n        resetForm();\n      } else {\n        navigate('/account');\n      }\n    } else {\n      setPasswordError(\n        validity.valueMissing\n          ? 'Please enter a password'\n          : 'Passwords must be at least 6 characters',\n      );\n    }\n  }\n\n  function resetForm() {\n    setShowEmailField(true);\n    setEmail('');\n    setEmailError(null);\n    setPassword('');\n    setPasswordError(null);\n  }\n\n  return (\n    <div className=\"flex justify-center my-24 px-4\">\n      <div className=\"max-w-md w-full\">\n        <h1 className=\"text-4xl\">Sign in.</h1>\n        <form noValidate className=\"pt-6 pb-8 mt-4 mb-4\" onSubmit={onSubmit}>\n          {hasSubmitError && (\n            <div className=\"flex items-center justify-center mb-6 bg-zinc-500\">\n              <p className=\"m-4 text-s text-contrast\">\n                Sorry we did not recognize either your email or password. Please\n                try to sign in again or create a new account.\n              </p>\n            </div>\n          )}\n          {showEmailField && (\n            <EmailField\n              shopName={shopName}\n              email={email}\n              setEmail={setEmail}\n              emailError={emailError}\n            />\n          )}\n          {!showEmailField && (\n            <ValidEmail email={email} resetForm={resetForm} />\n          )}\n          {!showEmailField && (\n            <PasswordField\n              password={password}\n              setPassword={setPassword}\n              passwordError={passwordError}\n            />\n          )}\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport async function callLoginApi({email, password}) {\n  try {\n    const res = await fetch(`/account/login`, {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({email, password}),\n    });\n    if (res.ok) {\n      return {};\n    } else {\n      return res.json();\n    }\n  } catch (error) {\n    return {\n      error: error.toString(),\n    };\n  }\n}\n\nfunction EmailField({email, setEmail, emailError, shopName}) {\n  return (\n    <>\n      <div className=\"mb-3\">\n        <input\n          className={`mb-1 appearance-none rounded border w-full py-2 px-3 text-primary/90 placeholder:text-primary/50 leading-tight focus:shadow-outline ${\n            emailError ? ' border-red-500' : 'border-gray-900'\n          }`}\n          id=\"email\"\n          name=\"email\"\n          type=\"email\"\n          autoComplete=\"email\"\n          required\n          placeholder=\"Email address\"\n          aria-label=\"Email address\"\n          // eslint-disable-next-line jsx-a11y/no-autofocus\n          autoFocus\n          value={email}\n          onChange={(event) => {\n            setEmail(event.target.value);\n          }}\n        />\n        {!emailError ? (\n          ''\n        ) : (\n          <p className={`text-red-500 text-xs`}>{emailError} &nbsp;</p>\n        )}\n      </div>\n      <div className=\"flex items-center justify-between\">\n        <button\n          className=\"bg-gray-900 rounded text-contrast py-2 px-4 focus:shadow-outline block w-full\"\n          type=\"submit\"\n        >\n          Next\n        </button>\n      </div>\n      <div className=\"flex items-center mt-8 border-t  border-gray-300\">\n        <p className=\"align-baseline text-sm mt-6\">\n          New to {shopName}? &nbsp;\n          <Link className=\"inline underline\" to=\"/account/register\">\n            Create an account\n          </Link>\n        </p>\n      </div>\n    </>\n  );\n}\n\nfunction ValidEmail({email, resetForm}) {\n  return (\n    <div className=\"mb-3 flex items-center justify-between\">\n      <div>\n        <p>{email}</p>\n        <input\n          className=\"hidden\"\n          type=\"text\"\n          autoComplete=\"username\"\n          value={email}\n          readOnly\n        ></input>\n      </div>\n      <div>\n        <button\n          className=\"inline-block align-baseline text-sm underline\"\n          type=\"button\"\n          onClick={resetForm}\n        >\n          Change email\n        </button>\n      </div>\n    </div>\n  );\n}\n\nfunction PasswordField({password, setPassword, passwordError}) {\n  return (\n    <>\n      <div className=\"mb-3\">\n        <input\n          className={`mb-1 appearance-none rounded border w-full py-2 px-3 text-primary/90 placeholder:text-primary/50 leading-tight focus:shadow-outline ${\n            passwordError ? ' border-red-500' : 'border-gray-900'\n          }`}\n          id=\"password\"\n          name=\"password\"\n          type=\"password\"\n          autoComplete=\"current-password\"\n          placeholder=\"Password\"\n          aria-label=\"Password\"\n          value={password}\n          minLength={8}\n          required\n          // eslint-disable-next-line jsx-a11y/no-autofocus\n          autoFocus\n          onChange={(event) => {\n            setPassword(event.target.value);\n          }}\n        />\n        {!passwordError ? (\n          ''\n        ) : (\n          <p className={`text-red-500 text-xs`}> {passwordError} &nbsp;</p>\n        )}\n      </div>\n      <div className=\"flex items-center justify-between\">\n        <button\n          className=\"bg-gray-900 text-contrast rounded py-2 px-4 focus:shadow-outline block w-full\"\n          type=\"submit\"\n        >\n          Sign in\n        </button>\n      </div>\n      <div className=\"flex items-center justify-between mt-4\">\n        <div className=\"flex-1\"></div>\n        <Link\n          className=\"inline-block align-baseline text-sm text-primary/50\"\n          to=\"/account/recover\"\n        >\n          Forgot password\n        </Link>\n      </div>\n    </>\n  );\n}\n"],"names":["shopName","navigate","useNavigate","hasSubmitError","setHasSubmitError","useState","showEmailField","setShowEmailField","email","setEmail","emailError","setEmailError","password","setPassword","passwordError","setPasswordError","event","preventDefault","checkEmail","checkPassword","currentTarget","validity","valid","response","callLoginApi","error","valueMissing","_jsx","_jsxs","res","fetch","method","headers","Accept","body","JSON","stringify","ok","json","toString","_Fragment","target","value","resetForm"],"mappings":"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"}
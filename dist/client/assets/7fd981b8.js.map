{"version":3,"file":"7fd981b8.js","sources":["../../../src/components/account/AccountDetailsEdit.client.jsx","../../../src/components/account/AccountDetails.client.jsx"],"sourcesContent":["import {useState} from 'react';\n\nimport {Text, Button} from '~/components';\nimport {\n  emailValidation,\n  passwordValidation,\n  useRenderServerComponents,\n} from '~/lib/utils';\n\nexport function AccountDetailsEdit({\n  firstName: _firstName = '',\n  lastName: _lastName = '',\n  phone: _phone = '',\n  email: _email = '',\n  close,\n}) {\n  const [saving, setSaving] = useState(false);\n  const [firstName, setFirstName] = useState(_firstName);\n  const [lastName, setLastName] = useState(_lastName);\n  const [phone, setPhone] = useState(_phone);\n  const [email, setEmail] = useState(_email);\n  const [emailError, setEmailError] = useState(null);\n  const [currentPasswordError, setCurrentPasswordError] = useState(null);\n  const [newPasswordError, setNewPasswordError] = useState(null);\n  const [newPassword2Error, setNewPassword2Error] = useState(null);\n  const [submitError, setSubmitError] = useState(null);\n\n  // Necessary for edits to show up on the main page\n  const renderServerComponents = useRenderServerComponents();\n\n  async function onSubmit(event) {\n    event.preventDefault();\n\n    setEmailError(null);\n    setCurrentPasswordError(null);\n    setNewPasswordError(null);\n    setNewPassword2Error(null);\n\n    const emailError = emailValidation(event.currentTarget.email);\n    if (emailError) {\n      setEmailError(emailError);\n    }\n\n    let currentPasswordError, newPasswordError, newPassword2Error;\n\n    // Only validate the password fields if the current password has a value\n    if (event.currentTarget.currentPassword.value) {\n      currentPasswordError = passwordValidation(\n        event.currentTarget.currentPassword,\n      );\n      if (currentPasswordError) {\n        setCurrentPasswordError(currentPasswordError);\n      }\n\n      newPasswordError = passwordValidation(event.currentTarget.newPassword);\n      if (newPasswordError) {\n        setNewPasswordError(newPasswordError);\n      }\n\n      newPassword2Error =\n        event.currentTarget.newPassword.value !==\n        event.currentTarget.newPassword2.value\n          ? 'The two passwords entered did not match'\n          : null;\n      if (newPassword2Error) {\n        setNewPassword2Error(newPassword2Error);\n      }\n    }\n\n    if (\n      emailError ||\n      currentPasswordError ||\n      newPasswordError ||\n      newPassword2Error\n    ) {\n      return;\n    }\n\n    setSaving(true);\n\n    const accountUpdateResponse = await callAccountUpdateApi({\n      email,\n      newPassword: event.currentTarget.newPassword.value,\n      currentPassword: event.currentTarget.currentPassword.value,\n      phone,\n      firstName,\n      lastName,\n    });\n\n    setSaving(false);\n\n    if (accountUpdateResponse.error) {\n      setSubmitError(accountUpdateResponse.error);\n      return;\n    }\n\n    renderServerComponents();\n    close();\n  }\n\n  return (\n    <>\n      <Text className=\"mt-4 mb-6\" as=\"h3\" size=\"lead\">\n        Update your profile\n      </Text>\n      <form noValidate onSubmit={onSubmit}>\n        {submitError && (\n          <div className=\"flex items-center justify-center mb-6 bg-red-100 rounded\">\n            <p className=\"m-4 text-sm text-red-900\">{submitError}</p>\n          </div>\n        )}\n        <div className=\"mt-3\">\n          <input\n            className={`appearance-none border w-full py-2 px-3 text-primary/90 placeholder:text-primary/50 leading-tight focus:shadow-outline border-gray-500 rounded`}\n            id=\"firstname\"\n            name=\"firstname\"\n            type=\"text\"\n            autoComplete=\"given-name\"\n            placeholder=\"First name\"\n            aria-label=\"First name\"\n            value={firstName}\n            onChange={(event) => {\n              setFirstName(event.target.value);\n            }}\n          />\n        </div>\n        <div className=\"mt-3\">\n          <input\n            className={`appearance-none border w-full py-2 px-3 text-primary/90 placeholder:text-primary/50 leading-tight focus:shadow-outline border-gray-500 rounded`}\n            id=\"lastname\"\n            name=\"lastname\"\n            type=\"text\"\n            autoComplete=\"family-name\"\n            placeholder=\"Last name\"\n            aria-label=\"Last name\"\n            value={lastName}\n            onChange={(event) => {\n              setLastName(event.target.value);\n            }}\n          />\n        </div>\n        <div className=\"mt-3\">\n          <input\n            className={`appearance-none border w-full py-2 px-3 text-primary/90 placeholder:text-primary/50 leading-tight focus:shadow-outline border-gray-500 rounded`}\n            id=\"phone\"\n            name=\"phone\"\n            type=\"tel\"\n            autoComplete=\"tel\"\n            placeholder=\"Mobile\"\n            aria-label=\"Mobile\"\n            value={phone}\n            onChange={(event) => {\n              setPhone(event.target.value);\n            }}\n          />\n        </div>\n        <div className=\"mt-3\">\n          <input\n            className={`appearance-none border w-full py-2 px-3 text-primary/90 placeholder:text-primary/50 leading-tight focus:shadow-outline rounded ${\n              emailError ? ' border-red-500' : 'border-gray-500'\n            }`}\n            id=\"email\"\n            name=\"email\"\n            type=\"email\"\n            autoComplete=\"email\"\n            required\n            placeholder=\"Email address\"\n            aria-label=\"Email address\"\n            value={email}\n            onChange={(event) => {\n              setEmail(event.target.value);\n            }}\n          />\n          <p\n            className={`text-red-500 text-xs ${!emailError ? 'invisible' : ''}`}\n          >\n            {emailError} &nbsp;\n          </p>\n        </div>\n        <Text className=\"mb-6 mt-6\" as=\"h3\" size=\"lead\">\n          Change your password\n        </Text>\n        <Password\n          name=\"currentPassword\"\n          label=\"Current password\"\n          passwordError={currentPasswordError}\n        />\n        <Password\n          name=\"newPassword\"\n          label=\"New password\"\n          passwordError={newPasswordError}\n        />\n        <Password\n          name=\"newPassword2\"\n          label=\"Re-enter new password\"\n          passwordError={newPassword2Error}\n        />\n        <Text\n          size=\"fine\"\n          color=\"subtle\"\n          className={`mt-1 ${\n            currentPasswordError || newPasswordError ? 'text-red-500' : ''\n          }`}\n        >\n          Passwords must be at least 6 characters.\n        </Text>\n        {newPassword2Error ? <br /> : null}\n        <Text\n          size=\"fine\"\n          className={`mt-1 text-red-500 ${\n            newPassword2Error ? '' : 'invisible'\n          }`}\n        >\n          {newPassword2Error} &nbsp;\n        </Text>\n        <div className=\"mt-6\">\n          <Button\n            className=\"text-sm mb-2\"\n            variant=\"primary\"\n            width=\"full\"\n            type=\"submit\"\n            disabled={saving}\n          >\n            Save\n          </Button>\n        </div>\n        <div className=\"mb-4\">\n          <Button\n            type=\"button\"\n            className=\"text-sm\"\n            variant=\"secondary\"\n            width=\"full\"\n            onClick={close}\n          >\n            Cancel\n          </Button>\n        </div>\n      </form>\n    </>\n  );\n}\n\nfunction Password({name, passwordError, label}) {\n  const [password, setPassword] = useState('');\n\n  return (\n    <div className=\"mt-3\">\n      <input\n        className={`appearance-none border w-full py-2 px-3 text-primary/90 placeholder:text-primary/50 leading-tight focus:shadow-outline rounded ${\n          passwordError ? ' border-red-500' : 'border-gray-500'\n        }`}\n        id={name}\n        name={name}\n        type=\"password\"\n        autoComplete={\n          name === 'currentPassword' ? 'current-password' : undefined\n        }\n        placeholder={label}\n        aria-label={label}\n        value={password}\n        minLength={8}\n        required\n        onChange={(event) => {\n          setPassword(event.target.value);\n        }}\n      />\n    </div>\n  );\n}\n\nexport async function callAccountUpdateApi({\n  email,\n  phone,\n  firstName,\n  lastName,\n  currentPassword,\n  newPassword,\n}) {\n  try {\n    const res = await fetch(`/account`, {\n      method: 'PATCH',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        email,\n        phone,\n        firstName,\n        lastName,\n        currentPassword,\n        newPassword,\n      }),\n    });\n    if (res.ok) {\n      return {};\n    } else {\n      return res.json();\n    }\n  } catch (_e) {\n    return {\n      error: 'Error saving account. Please try again.',\n    };\n  }\n}\n","import {Seo} from '@shopify/hydrogen';\nimport {useState} from 'react';\nimport {Modal} from '../index';\nimport {AccountDetailsEdit} from './AccountDetailsEdit.client';\n\nexport function AccountDetails({firstName, lastName, phone, email}) {\n  const [isEditing, setIsEditing] = useState(false);\n\n  const close = () => setIsEditing(false);\n\n  return (\n    <>\n      {isEditing ? (\n        <Modal close={close}>\n          <Seo type=\"noindex\" data={{title: 'Account details'}} />\n          <AccountDetailsEdit\n            firstName={firstName}\n            lastName={lastName}\n            phone={phone}\n            email={email}\n            close={close}\n          />\n        </Modal>\n      ) : null}\n      <div className=\"grid w-full gap-4 p-4 py-6 md:gap-8 md:p-8 lg:p-12\">\n        <h3 className=\"font-bold text-lead\">Account Details</h3>\n        <div className=\"lg:p-8 p-6 border border-gray-200 rounded\">\n          <div className=\"flex\">\n            <h3 className=\"font-bold text-base flex-1\">Profile & Security</h3>\n            <button\n              className=\"underline text-sm font-normal\"\n              onClick={() => setIsEditing(true)}\n            >\n              Edit\n            </button>\n          </div>\n          <div className=\"mt-4 text-sm text-primary/50\">Name</div>\n          <p className=\"mt-1\">\n            {firstName || lastName\n              ? (firstName ? firstName + ' ' : '') + lastName\n              : 'Add name'}{' '}\n          </p>\n\n          <div className=\"mt-4 text-sm text-primary/50\">Contact</div>\n          <p className=\"mt-1\">{phone ?? 'Add mobile'}</p>\n\n          <div className=\"mt-4 text-sm text-primary/50\">Email address</div>\n          <p className=\"mt-1\">{email}</p>\n\n          <div className=\"mt-4 text-sm text-primary/50\">Password</div>\n          <p className=\"mt-1\">**************</p>\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":["firstName","_firstName","lastName","_lastName","phone","_phone","email","_email","close","saving","setSaving","useState","setFirstName","setLastName","setPhone","setEmail","emailError","setEmailError","currentPasswordError","setCurrentPasswordError","newPasswordError","setNewPasswordError","newPassword2Error","setNewPassword2Error","submitError","setSubmitError","renderServerComponents","useRenderServerComponents","event","preventDefault","emailValidation","currentTarget","currentPassword","value","passwordValidation","newPassword","newPassword2","accountUpdateResponse","callAccountUpdateApi","error","_Fragment","_jsx","_jsxs","target","name","passwordError","label","password","setPassword","undefined","res","fetch","method","headers","Accept","body","JSON","stringify","ok","json","isEditing","setIsEditing","title"],"mappings":"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"}